[{"title":"Unity设计一个简单的手柄输入系统","url":"/2025/04/13/GameDev/gamedev-gamepad/","content":"\n## 前言\n\n在网上查资料的时候发现，关于手柄的资料真是少之又少，而且技术点也很分散\n\n可能是因为太简单大家都不需要吧(\n\n而且有需要的项目有大佬自带体系，一般独游也够用就行\n\n本篇文章会大概讲解一下一款游戏该怎么搭起一套完整的手柄流程\n\n不过现在插件也多，加速了开发，方便懒人\n\n所以本篇文章只适合想自己造轮子的人\n\n> 注: 本文以思路为主，不扣细节，基于Unity，涉及少量代码，需要一点点的代码知识\n\n## 组成\n\n手柄其实没啥花活，在一款游戏中手柄主要就两个部分\n\n- 操作: 角色操作 UI\n- 反馈: 震动 自适应扳机 等\n\n接下来就从最基础的输入操作开始\n\n### 操作\n\n#### 搓个InputManager\n\n想要开始，首先就得有一个地方管理输入\n\n所以我们会有一个InputManager来管理无论是来自键盘鼠标还是手柄的输入\n\n在Unity里，一个按键可能就是 Input.GetKey() 或者 Keyboard.current.xxxKey.IsPressed，显然这个是不够用的\n\n如果我们需要一个按键干N件事，不同的输入设备的某个按键触发某个相同的逻辑，这样硬写实在太丑陋了\n\n所以需要对基础功能进行封装\n\nUI操作和基础角色操做虽然有耦合，但是基本是区分开的，你也不想在操控UI的时候输入指令被角色NTR吧.jpg\n\n所以第一步是需要定义好操作的行为类型，再定义操作的具体行为\n\n比如对行为类型进行分组，分别是Battle，UI\n\n在Battle或UI下又有自己的确定行为，比如Attack，UIXxxxx\n\n```c#\npublic enum EInputGroupType{\n    Battle,\n    UI\n}\npublic enum EBattleInputType{\n    Attack,\n    Move,\n    etc....,\n}\npublic enum EUIInputType{\n    UICancel,\n    UIConfirm,\n    ...\n}\n```\n\n有了确定行为后，那我怎么知道这个行为触发了？\n\n这时需要创建一个属于我们自己的输入单元，\n\n这个输入单元包含了\n\n- 按键配置\n- 按键状态\n- 按键的操作类型\n- 按键事件\n\n```c#\npublic class ButterButton{\n    public 按键行为;\n    public 按键1;\n    public 按键2;\n    \n    public bool 是否按下;\n    public bool 是否按住;\n}\n```\n\n然后就是根据输入的行为配置一堆输入单元，需要用的地方监听事件，再根据当前的情形对输入进行组的切换\n\n在InputManager的每帧Tick里分发事件\n\n一个简单的InputManager就完事了\n\n#### 搓个手柄UI组件\n\n想要定制不同组件的操作，那就逃不开写代码了\n\nUnity本身似乎支持一定程度的操作，但是我是都搓完了才发现( ，也就没细研究\n\n那么手柄UI组件是啥\n\n小的说就是Button，Slider这些基础控件\n\n大了就是控件的组合，ScrollView/Tab导航等\n\n然后一个组件需要哪些属性？\n\n- 聚焦状态(聚焦态的组件才能响应输入事件)\n- 按键配置\n- 按键行为\n\n```c#\npublic class GamepadComponent{\n    public bool Focus;\n    public 按键;\n    \n    public bool OnInput(按键,是否按下,是否按住);\n}\n```\n\n所有组件继承自这个GamepadComponent，在OnInput里封装对应行为就完事了\n\n但比较特殊的有ScrollView，当进行Item选取的时候，需要有一个自动ScrollTo的行为\n\n这里推荐一个开源组件直接下载即用[UIScrollToSelection](https://github.com/sarbian/KSPUIHelper/blob/master/unity-ui-extensions/Utilities/UIScrollToSelection.cs)\n\n想要效果好可以进行一定的修改，比如移动到第N个单位时，ScrollTo第N+1个单位，额外显示一行\n\n> 注：同时可以有多个聚焦的组件存在，但是按键不应一致，比如Tab页面的TabButton组和这个页面里的某个组件是同时处于聚焦态的\n\n另外需要有一个特殊的组件叫Selectable，可选取的组件都应该继承或直接使用他\n\n由Selectedable来响应选中/确定等常见事件\n\n#### 响应输入事件\n\n组件有了InputManager也有了，接下来就是响应操作\n\n在InputManager的Tick中，收集好当前激活的UI下处于聚焦状态的组件按键列表\n\n挨个检测按键状态并发送就行\n\n​\t\t\n\n思路其实就这么简单，具体细节开发不同项目不同做法，所以也确实没什么人需要分享吧\n\n### 反馈\n\n自适应扳机什么的纯看项目，所以就只讲震动\n\n想做手柄的奇怪反馈功能，需要定义一个手柄控制器\n\n```c#\npublic class GamepadController{\n    public List<IGamepadModule> Modules; \n}\n```\n\n手柄由多个模块组成，在每个模块管理相应的功能\n\n震动就在RumbleModule里\n\n震动所需的参数\n\n- 左马达频率\n- 右马达频率\n- 时间\n- 曲线\n\n曲线能让震动更加的平滑和可控，想要好手感是必须的\n\n调用震动的做法推荐使用多模板+部分自定义\n\n根据游戏攻击类型/事件类型，分好几个大类，在大类下细分轻中重，能满足80%的情况\n\n剩下的就是纯自定义做特殊的震动，比如Boss战演出之类的\n\n### 效果\n\n![gamepad](gamepad.gif)\n\n\n\n\n\n\n\n\n\n\n\n","tags":["Unity"],"categories":["游戏开发"]},{"title":"2025年一月番+部分补番记录","url":"/2025/04/13/animation/20252ndseason/","content":"\n一月新番也结束了，算上24年10月开播的半年番一共看了30部\n\n从清明开始到今天，补了9部\n\n## 一月番\n\n### 顶级\n\n我独自升级 第二季\n\n> 要是单说剧情音乐什么的很一般，但是真的无脑爽文，作画顶级，爽就完事了\n\n### 优秀\n\n金牌得主\n\n> 优秀原作+优秀动画制作\n\n青之箱 \n\n> 我是真喜欢败犬角色\n\n全修\n\n> 低开高走，作为原创，不错\n\n在冲绳喜欢上的女孩方言讲得太过令人困扰\n\n> 女二可爱\n\n一杆青空\n\n> 永远相信齐藤健吾画的美少女\n\n地。 ―关于地球的运动―\n\n> 原作相当优秀，便宜动画也看的比较开心\n\n超超超超超喜欢你的100个女朋友 第二季\n\n### 中规中矩\n\n浪客剑心 －明治剑客浪漫谭－ 京都动乱\n\n我的幸福婚姻 第二季\n\n黄昏旅店\n\n群花绽放，彷如修罗\n\n> 其实也能算优秀？输在我对朗读剧不是很了解，另外怎么你们也少女斗财阀\n\n天久鹰央的推理病历表\n\n战队红战士在异世界当冒险者\n\n缘结甘神家\n\n这公司有我喜欢的人\n\n香格里拉·弗陇提亚～屎作猎人向神作发起挑战～ 第二季\n\n中年上班族转生恶役\n\n石纪元 科学与未来\n\n坂本日常\n\n### 能看\n\n刹那之花\n\n> 肉体能看\n\n我和班上最讨厌的女生结婚了\n\n> 女主的傲娇傲的不是很讨喜，妹妹真可爱\n\n迟早是最强的炼金术师？\n\n魔法制造者\n\n> 角色真好看\n\n### 烂\n\n> 不明白为什么我看完了\n\n最弱技能《果实大师》 ～关于能无限食用技能果实（吃了就会死）这件事～\n\n不幸职业【鉴定士】实则最强\n\n蜂蜜柠檬苏打\n\nS级怪兽《贝希摩斯》被误认成小猫，成为精灵女孩的骑士一起生活\n\n### 论外\n\nBanG Dream! Ave Mujica\n\n> 只看13集的Live，无敌\n>\n> 乐队不应该是KIRAKIRA DOKIDOKI的吗\n\n\n\n## 补番\n\n贫穷姐妹物语\n\n> あす太可爱了，爱看可怜的美少女\n>\n> 第十集姐姐削苹果那段无敌\n\nTo Heart\n\n> 第六集 憧れ\n\n老人Z\n\n世纪末超自然学院\n\n> 断断续续看了几年，只记得女主的绝对领域了\n\n魔法少女奈叶\n\n> 也是断断续续看了几年，然后一口气看完四季\n>\n> 还是性压抑了，StrikerS的制服好涩\n\nOVERLORD 圣王国篇\n\n> 小说剧情虽然忘光了，但真不愧是安兹大人\n","tags":["一月新番"],"categories":["动画"]},{"title":"花组活动剧情-YOUR/MY Love letter","url":"/2025/04/12/Misc/yourmyloveletter/","content":"\n虽然是2022年的剧情\n\n[B站可以云的地址](https://www.bilibili.com/video/BV1ia411472C)\n\n#### 剧情结构\n\n- Opening I am.  (我是)\n- 第1話 song for Someone  (為了某人歌唱)\n- 第2話 voice for Someone  (為了某人知音)\n- 第3話 color for Someone  (為了某人成色)\n- 第4話 off stage  (台下)\n- 第5話 good night  (晚安)\n- 第6話 present  (呈獻)\n- Ending You are.  (你是)\n\n这是能免费看的吗\n\n剧情大部分的文本只是在描述忙碌一般通过人士，TA可能是职员，教师，在便利店打工的大学生\n\n而偶像有时出现在广播，广告，背景乐\n\n这便是偶像与一般人之间的联系，推只是大家生活的一部分\n\n现实可能是苦涩，迷茫，透不过气\n\n也正是这样的日常也存在奇迹(让人羡慕的偶遇小偶像\n\n每个人都是自己人生的主角，偶像也仅是他们人生的配角\n\n**写的真好，伟大**\n\n","tags":["偶像大师"],"categories":["杂"]},{"title":"黄油界的黑魂--好像知道怎么做'神作'了","url":"/2025/04/12/Game/butter-blacksouls/","content":"\n![](blacksouls2.webp)\n\n最近闲来无事通了BlackSouls1代+2代(2代打了几小时就云通关了)\n\n以下是也许不带剧透的感想\n\n先总结一下游戏优缺点\n\n主要针对BlackSouls2\n\n##### 优点\n\n- 结合世界观的有趣设定(这种设定似乎再往前比较知名的就只有沙耶之歌？\n- 风格鲜明的CG？\n\n##### 缺点\n\n- 糟糕的引导\n- 劝退玩家的开场\n\n  \n\n### 剧情\n\n涉及了些伦理问题，所以大概也只有黄油能写出这样的剧情了\n\n如果把游戏改成全年龄版，也算是个佳作\n\n不过成人向け还是上大分，就想看点神经病的东西\n\n### 游戏性\n\n首先总结以下近几年所谓的**神作**的共同特征:\n\n- 不好好说话的碎片化叙事\n- 没有引导\n- 表面上的允许玩家**按照自己想法**玩游戏\n\n你是个小卡拉米，初来乍到一个人生地不熟的地方，然后游戏就开始了，要干什么呢，不明说。\n\n~~这也是种开放世界.jpg~~\n\n如果你的游戏占了以上几点恭喜你，有神作的潜质(\n\nBlackSouls有点像，但不全是，NPC还是会和你好好说话的\n\n不过引导过于糟糕了，游戏的地图/数值大概都是为多周目所设计的\n\n低周目的情况下，虽然看着哪都能去，实则因为数值原因哪都不能去\n\n在非回合制的游戏里，可以通过强大的手部乘区弥补数值上的劣势\n\n可不好意思，这里是BlackSouls2，乖乖站好给我一刀秒\n\n所以看似选项很多，走的路线其实相对还是比较固定的\n\n  \n\n除此之外的就中规中矩了,文章写的有点烂\n\n会越来越好的(应该\n\n\n\n\n\n","tags":["黄油"],"categories":["游戏"]},{"title":"第一篇Post就是你了","url":"/2025/04/11/hello-world/","content":"字数补丁\n"}]